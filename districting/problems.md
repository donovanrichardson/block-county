the logs are below. they reveal a few things wrong with the process in the script.

## problems

the collection of tracts is repeatedly split into districts of one tract of zero population. these zero population districts should be expanding into the district with populaiton. why is this incorrect behavior happening?

Also, at the end of the script, many districts are ending with population far larger than 776971. the funcction should be recurring until each district has about 776971 population. why is this happening? create a new md file to asnwer my questions.

## logs

/Users/donovan/.local/share/virtualenvs/block-county-NfjC8wka/bin/python /Users/donovan/Dropbox/codebases2025/block-county/districting/assign_districts_new_york.py
=== New York State Congressional District Assignment ===
Target: 26 districts

[Step 1] Fetching tract centroids for New York State (FIPS 36)...
Found 5411 tracts
Total population: 20201249
Target district population: 776971

[Step 2] Building distance matrix...
Building distance matrix for 5411 tracts...
Max finite distance in matrix: 1.71e+11

[Step 3] Running recursive K-Medoids clustering...
[Split] Cluster '' has 5411 tracts, pop=20201249, target=26 districts
Initial split: cluster 0 pop=0, cluster 1 pop=20201249
Cluster 0 will have 1 districts, cluster 1 will have 26 districts
[Split] Cluster '1' has 5410 tracts, pop=20201249, target=26 districts
Initial split: cluster 10 pop=0, cluster 11 pop=20201249
Cluster 10 will have 1 districts, cluster 11 will have 26 districts
[Split] Cluster '11' has 5409 tracts, pop=20201249, target=26 districts
Initial split: cluster 110 pop=0, cluster 111 pop=20201249
Cluster 110 will have 1 districts, cluster 111 will have 26 districts
[Split] Cluster '111' has 5408 tracts, pop=20201249, target=26 districts
Initial split: cluster 1110 pop=0, cluster 1111 pop=20201249
Cluster 1110 will have 1 districts, cluster 1111 will have 26 districts
[Split] Cluster '1111' has 5407 tracts, pop=20201249, target=26 districts
Initial split: cluster 11110 pop=0, cluster 11111 pop=20201249
Cluster 11110 will have 1 districts, cluster 11111 will have 26 districts
[Split] Cluster '11111' has 5406 tracts, pop=20201249, target=26 districts
Initial split: cluster 111110 pop=0, cluster 111111 pop=20201249
Cluster 111110 will have 1 districts, cluster 111111 will have 26 districts
[Split] Cluster '111111' has 5405 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111110 pop=0, cluster 1111111 pop=20201249
Cluster 1111110 will have 1 districts, cluster 1111111 will have 26 districts
[Split] Cluster '1111111' has 5404 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111110 pop=0, cluster 11111111 pop=20201249
Cluster 11111110 will have 1 districts, cluster 11111111 will have 26 districts
[Split] Cluster '11111111' has 5403 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111110 pop=0, cluster 111111111 pop=20201249
Cluster 111111110 will have 1 districts, cluster 111111111 will have 26 districts
[Split] Cluster '111111111' has 5402 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111110 pop=0, cluster 1111111111 pop=20201249
Cluster 1111111110 will have 1 districts, cluster 1111111111 will have 26 districts
[Split] Cluster '1111111111' has 5401 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111110 pop=0, cluster 11111111111 pop=20201249
Cluster 11111111110 will have 1 districts, cluster 11111111111 will have 26 districts
[Split] Cluster '11111111111' has 5400 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111110 pop=0, cluster 111111111111 pop=20201249
Cluster 111111111110 will have 1 districts, cluster 111111111111 will have 26 districts
[Split] Cluster '111111111111' has 5399 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111110 pop=0, cluster 1111111111111 pop=20201249
Cluster 1111111111110 will have 1 districts, cluster 1111111111111 will have 26 districts
[Split] Cluster '1111111111111' has 5398 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111110 pop=0, cluster 11111111111111 pop=20201249
Cluster 11111111111110 will have 1 districts, cluster 11111111111111 will have 26 districts
[Split] Cluster '11111111111111' has 5397 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111110 pop=0, cluster 111111111111111 pop=20201249
Cluster 111111111111110 will have 1 districts, cluster 111111111111111 will have 26 districts
[Split] Cluster '111111111111111' has 5396 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111110 pop=0, cluster 1111111111111111 pop=20201249
Cluster 1111111111111110 will have 1 districts, cluster 1111111111111111 will have 26 districts
[Split] Cluster '1111111111111111' has 5395 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111110 pop=0, cluster 11111111111111111 pop=20201249
Cluster 11111111111111110 will have 1 districts, cluster 11111111111111111 will have 26 districts
[Split] Cluster '11111111111111111' has 5394 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111110 pop=0, cluster 111111111111111111 pop=20201249
Cluster 111111111111111110 will have 1 districts, cluster 111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111' has 5393 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111110 pop=0, cluster 1111111111111111111 pop=20201249
Cluster 1111111111111111110 will have 1 districts, cluster 1111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111' has 5392 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111110 pop=0, cluster 11111111111111111111 pop=20201249
Cluster 11111111111111111110 will have 1 districts, cluster 11111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111' has 5391 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111110 pop=0, cluster 111111111111111111111 pop=20201249
Cluster 111111111111111111110 will have 1 districts, cluster 111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111' has 5390 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111110 pop=0, cluster 1111111111111111111111 pop=20201249
Cluster 1111111111111111111110 will have 1 districts, cluster 1111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111' has 5389 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111110 pop=0, cluster 11111111111111111111111 pop=20201249
Cluster 11111111111111111111110 will have 1 districts, cluster 11111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111' has 5388 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111110 pop=0, cluster 111111111111111111111111 pop=20201249
Cluster 111111111111111111111110 will have 1 districts, cluster 111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111' has 5387 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111110 pop=0, cluster 1111111111111111111111111 pop=20201249
Cluster 1111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111' has 5386 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111110 pop=0, cluster 11111111111111111111111111 pop=20201249
Cluster 11111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111' has 5385 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111110 pop=0, cluster 111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111' has 5384 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111110 pop=0, cluster 1111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111' has 5383 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111110 pop=0, cluster 11111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111' has 5382 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111' has 5380 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111' has 5379 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111' has 5378 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111' has 5377 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111' has 5376 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111' has 5375 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111' has 5374 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111' has 5373 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111111' has 5372 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111111' has 5371 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111111' has 5370 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111111111' has 5369 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111111111' has 5368 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111111111' has 5367 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111111111111' has 5366 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111111111111' has 5365 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111111111111' has 5364 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111111111111111' has 5363 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111111111111111' has 5362 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111111111111111' has 5361 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111111111111111110 pop=0, cluster 11111111111111111111111111111111111111111111111111 pop=20201249
Cluster 11111111111111111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '11111111111111111111111111111111111111111111111111' has 5360 tracts, pop=20201249, target=26 districts
Initial split: cluster 111111111111111111111111111111111111111111111111110 pop=0, cluster 111111111111111111111111111111111111111111111111111 pop=20201249
Cluster 111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '111111111111111111111111111111111111111111111111111' has 5359 tracts, pop=20201249, target=26 districts
Initial split: cluster 1111111111111111111111111111111111111111111111111110 pop=0, cluster 1111111111111111111111111111111111111111111111111111 pop=20201249
Cluster 1111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111111111111111 will have 26 districts
[Split] Cluster '1111111111111111111111111111111111111111111111111111' has 5358 tracts, pop=20201249, target=26 districts
Initial split: cluster 11111111111111111111111111111111111111111111111111110 pop=4674779, cluster 11111111111111111111111111111111111111111111111111111 pop=15526470
Rebalanced: transferred 248 tracts from 11111111111111111111111111111111111111111111111111111 to 11111111111111111111111111111111111111111111111111110
After rebalancing: 11111111111111111111111111111111111111111111111111110 pop=5440570, 11111111111111111111111111111111111111111111111111111 pop=14760679
Cluster 11111111111111111111111111111111111111111111111111110 will have 7 districts, cluster 11111111111111111111111111111111111111111111111111111 will have 19 districts
[Split] Cluster '11111111111111111111111111111111111111111111111111110' has 1621 tracts, pop=5440570, target=7 districts
Initial split: cluster 111111111111111111111111111111111111111111111111111100 pop=900771, cluster 111111111111111111111111111111111111111111111111111101 pop=4539799
Rebalanced: transferred 599 tracts from 111111111111111111111111111111111111111111111111111101 to 111111111111111111111111111111111111111111111111111100
After rebalancing: 111111111111111111111111111111111111111111111111111100 pop=2889860, 111111111111111111111111111111111111111111111111111101 pop=2550710
Cluster 111111111111111111111111111111111111111111111111111100 will have 1 districts, cluster 111111111111111111111111111111111111111111111111111101 will have 1 districts
[Split] Cluster '11111111111111111111111111111111111111111111111111111' has 3737 tracts, pop=14760679, target=19 districts
Initial split: cluster 111111111111111111111111111111111111111111111111111110 pop=636645, cluster 111111111111111111111111111111111111111111111111111111 pop=14124034
Rebalanced: transferred 133 tracts from 111111111111111111111111111111111111111111111111111111 to 111111111111111111111111111111111111111111111111111110
After rebalancing: 111111111111111111111111111111111111111111111111111110 pop=1067023, 111111111111111111111111111111111111111111111111111111 pop=13693656
Cluster 111111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111111111111111 will have 13 districts
[Split] Cluster '111111111111111111111111111111111111111111111111111111' has 3423 tracts, pop=13693656, target=13 districts
Initial split: cluster 1111111111111111111111111111111111111111111111111111110 pop=1181483, cluster 1111111111111111111111111111111111111111111111111111111 pop=12512173
Rebalanced: transferred 118 tracts from 1111111111111111111111111111111111111111111111111111111 to 1111111111111111111111111111111111111111111111111111110
After rebalancing: 1111111111111111111111111111111111111111111111111111110 pop=1556192, 1111111111111111111111111111111111111111111111111111111 pop=12137464
Cluster 1111111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 1111111111111111111111111111111111111111111111111111111 will have 8 districts
[Split] Cluster '1111111111111111111111111111111111111111111111111111111' has 3028 tracts, pop=12137464, target=8 districts
Initial split: cluster 11111111111111111111111111111111111111111111111111111110 pop=1365919, cluster 11111111111111111111111111111111111111111111111111111111 pop=10771545
Rebalanced: transferred 264 tracts from 11111111111111111111111111111111111111111111111111111111 to 11111111111111111111111111111111111111111111111111111110
After rebalancing: 11111111111111111111111111111111111111111111111111111110 pop=2525367, 11111111111111111111111111111111111111111111111111111111 pop=9612097
Cluster 11111111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 11111111111111111111111111111111111111111111111111111111 will have 4 districts
[Split] Cluster '11111111111111111111111111111111111111111111111111111111' has 2437 tracts, pop=9612097, target=4 districts
Initial split: cluster 111111111111111111111111111111111111111111111111111111110 pop=480848, cluster 111111111111111111111111111111111111111111111111111111111 pop=9131249
Rebalanced: transferred 1318 tracts from 111111111111111111111111111111111111111111111111111111111 to 111111111111111111111111111111111111111111111111111111110
After rebalancing: 111111111111111111111111111111111111111111111111111111110 pop=5055086, 111111111111111111111111111111111111111111111111111111111 pop=4557011
Cluster 111111111111111111111111111111111111111111111111111111110 will have 1 districts, cluster 111111111111111111111111111111111111111111111111111111111 will have 1 districts